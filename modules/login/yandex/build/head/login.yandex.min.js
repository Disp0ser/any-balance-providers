function loginYandex(e,f,a,b,d){function g(a){return getParam(a,null,null,/<input[^>]*name="idkey"[^>]*value="([^"]*)/i)}var c="https://passport.yandex.ru/passport?mode=auth";d&&(c+="&from="+encodeURIComponent(d));b&&(c+="&retpath="+encodeURIComponent(b));a||(a=AnyBalance.requestGet(c,g_headers));a=(a=g(a))?AnyBalance.requestPost(c,{from:d||"passport",retpath:b,idkey:a,display:"page",login:e,passwd:f,timestamp:(new Date).getTime()},g_headers):AnyBalance.requestPost(c,{retpath:b,login:e,passwd:f},
addHeaders({Referer:c}));var h=getParam(a,null,null,/<img[^>]+captcha__text[^>]*src="([^"]*)/i,replaceHtmlEntities);!/logout/i.test(a)&&h&&(b=AnyBalance.getLastUrl(),AnyBalance.trace("Затребована капча, придется показывать"),a=AB.createFormParams(a,function(a,c,b,d){return"login"==b?e:"passwd"==b?f:"answer"==b?(a=AnyBalance.requestGet(h,g_headers),AnyBalance.retrieveCode("Пожалуйста, введите символы с картинки",a)):d}),a=AnyBalance.requestPost(b,a,addHeaders({Referer:b})));if(!/logout|balance-widget/i.test(a)){if(c=
getParam(a,null,null,[/b\-login\-error[^>]*>([\s\S]*?)<\/strong>/i,/error-msg[^>]*>([^<]+)/i],replaceTagsAndSpaces,html_entity_decode))throw new AnyBalance.Error(c,null,/Учётной записи с таким логином не существует|Неправильная пара логин-пароль|Неправильный логин или пароль|Нет аккаунта с таким логином/i.test(c));if(/Нам пришлось заблокировать ваш IP/i.test(a))throw new AnyBalance.Error("Яндекс временно заблокировал ваш IP. Возможно, с этого IP было много входов. Пожалуйста, подождите часок и попробуйте ещё раз.");
AnyBalance.trace(a);throw new AnyBalance.Error("Не удалось зайти в личный кабинет Яндекса. Сайт изменен?");}/Установить постоянную авторизацию на(?:\s|&nbsp;)+данном компьютере\?/i.test(a)&&(AnyBalance.trace("Яндекс спрашивает, нужно ли запоминать этот компьютер. Отвечаем, что нет... (idkey="+g(a)+")"),a=AnyBalance.requestPost(c,{filled:"yes",timestamp:(new Date).getTime(),idkey:g(a),no:1},g_headers));return a};
